# Функция конструктор Base

Функции-конструкторы технически являются обычными функциями. Но есть два соглашения:

1. Имя функции-конструктора должно начинаться с большой буквы.
2. Функция-конструктор должна выполняться только с помощью оператора `"new"`.
3. **  можно вызвать без скобок - `let` user `=` `new` `User;` ←— плохая практика / валидно

Когда функция вызывается как `new User(...)`, происходит следующее:

1. Создаётся новый пустой объект, и он присваивается `this`.
2. Выполняется тело функции. Обычно оно модифицирует `this`, добавляя туда новые свойства.
3. Возвращается значение `this`.

Другими словами, `new User(...)` делает что-то вроде:

```
function User(name) {
    // this = {};  (неявно)
  
    // добавляет свойства к this
    this.name = name;
    this.isAdmin = false;
  
    // return this;  (неявно)
}
```

***Проверка на вызов в режиме конструктора: new.target***

Используя специальное свойство `new.target` внутри функции, мы можем проверить, вызвана ли функция при помощи оператора `new` или без него.

В случае обычного вызова функции `new.target` будет `undefined`. Если же она была вызвана при помощи `new`, `new.target` будет равен самой функции.

```jsx
function User() {
    alert(new.target);
}
  
// без "new":
User(); // undefined
  
// с "new":
new User(); // function User { ... }
```

Также мы можем сделать, чтобы вызовы с `new` и без него делали одно и то же:

```jsx
function User(name) {
    if (!new.target) { // в случае, если вы вызвали меня без оператора new
      return new User(name); // ...я добавлю new за вас
    }
  
    this.name = name;
}
  
let john = User("John"); // переадресовывает вызов на new User
alert(john.name); // John
```

***Возврат значения из конструктора, return***

Без явного  `return` - из функции конструктора возвращается `this`

Но если `return` всё же есть, то применяется простое правило:

- При вызове `return` с объектом, вместо `this` вернётся объект.
- При вызове `return` с примитивным значением, оно проигнорируется.

Другими словами, `return` с объектом возвращает этот объект, во всех остальных случаях возвращается `this`.