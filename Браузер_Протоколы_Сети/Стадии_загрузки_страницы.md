# Стадии загрузки страницы

1. Начало разбора HTML
2. Получение внешних ресурсов
3. Разбор CSS и создание CSSOM
4. Выполнение JavaScript
5. Объединение DOM и CSSOM, для построения дерева рендеринга
6. Расчет макета и отрисовка результата

---

1. Синтаксический анализ HTML (разбиение HTML на токены, начальные / конечные тэги), на основе анализа - построение DOM

2. Когда парсер встречает сторонние ресурсы ( файлы CSS  или  JS) он пытается получить их. Синтаксический анализатор будет продолжать работу (с указанием флагов для JS)

- Загрузка CSS блокирует рендеринг
  Указатель повышения приоритетности необходимых ресурсов 
     *<link href="style.css" rel="preload" as="style" />*

- Загрузка JS, есть настройки у тега ‘script’ позволяющие контролировать выполнение загруженного скрипта
   **async -** выполнение файла отложено до завершения синтаксического анализа документа
   **defer -**  файл будет выполнен, как только он загрузится, это может быть во время или после процесса синтаксического анализа

3. Разбор CSS и создание CSS OM
Объектная модель CSS (CSSOM) – это карта всех селекторов CSS и соответствующих свойств для каждого селектора в форме дерева с корневым узлом.
CSSOM вместе с DOM используется для построения дерева рендеринга, которое, в свою очередь, используется браузером для компоновки и раскраски веб-страницы.
**Отличие от DOM -  что он не может быть построен постепенно, положение элементов может зависеть друг от друга. Вот почему загрузка CSS блокирует рендеринг.**

4. Компиляция / Выполнение JavaScript
После того, как синхронно загруженный JavaScript и DOM будут полностью проанализированы и готовы, будет сгенерировано событие [document.DOMContentLoaded](https://developer.mozilla.org/en-US/docs/Web/API/Document/DOMContentLoaded_event). 

```jsx
document.addEventListener('DOMContentLoaded', (event) => {
    // You can now safely access the DOM
});
```

5. Стадии - Style calculation, Layout, Paint, Composition
Объединение DOM и CSSOM, для построения дерева рендеринга
[Дерево рендеринга](https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction) представляет собой комбинацию DOM и CSSOM и представляет все, что будет отображаться на странице. Это не обязательно означает, что все узлы в дереве рендеринга будут **визуально присутствовать**, например узлы со стилями opacity: 0 или visibility: hidden будут включены и могут быть прочитаны программой чтения с экрана и т. д., тогда как те, которые настроены на display: none будет исключены. Кроме того, такие теги, как <head>, не содержащие визуальной информации, всегда будут пропущены.

6. Когда у нас есть полное дерево рендеринга, браузер знает, что рендерить, но не знает, где рендерить. Следовательно, необходимо рассчитать макет страницы (то есть положение и размер каждого узла). Механизм рендеринга проходит дерево рендеринга, начиная с вершины и идя вниз, вычисляет координаты, в которых должен отображаться каждый узел.
Затем рисует пиксели на экране.
