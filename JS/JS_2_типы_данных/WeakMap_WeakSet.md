# WeakMap и WeakSet

- Работают только с ключами - объектами
- имеют ограниченный набор методов

`WeakMap` – это `Map`-подобная коллекция, ***позволяющая использовать в качестве ключей только объекты,*** и автоматически удаляющая их вместе с соответствующими значениями, как только они становятся недостижимыми иными путями.

`WeakSet` – это `Set`-подобная коллекция, ***которая хранит только объекты и удаляет их, как только они становятся недостижимыми иными путями***.

Как мы знаем из главы [Сборка мусора](https://learn.javascript.ru/garbage-collection), движок JavaScript хранит значения в памяти до тех пор, пока они достижимы (то есть, эти значения могут быть использованы).

```jsx
let john = { name: "John" };
// объект доступен, переменная john — это ссылка на него
// перепишем ссылку

john = null;
// объект будет удалён из памяти
```

`WeakMap` не поддерживает перебор и методы `keys()`, `values()`, `entries()`, так что нет способа взять все ключи или значения из неё.

В `WeakMap` присутствуют только следующие методы:

- `weakMap.get(key)`
- `weakMap.set(key, value)`
- `weakMap.delete(key)`
- `weakMap.has(key)`

Может применяться для реализации кеширования, с преимуществом перед обычным Map тем, что не нужно впоследствии вручную очищать кэш - это сделает сборщик мусора JS

В `WeakSet` присутствуют только следующие методы:

- `weakMap.add(key, value)`
- `weakMap.delete(key)`
- `weakMap.has(key)`

`WeakSet` ***не поддерживает `size`, `keys()` и не является перебираемой.***

`WeakMap` и `WeakSet` используются как вспомогательные структуры данных в дополнение к «основному» месту хранения объекта. Если объект удаляется из основного хранилища и нигде не используется, кроме как в качестве ключа в `WeakMap` или в `WeakSet`, то он будет удалён автоматически.